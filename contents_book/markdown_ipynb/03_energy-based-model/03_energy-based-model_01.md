# 第3章：エネルギーベースモデル
## エネルギーベースモデルの基礎
本章では、**エネルギーベースモデル**（energy-based models; EBMs）と呼ばれる確率モデルの枠組みを取り上げる。

エネルギーベースモデルでは，系の状態に

EBMsは、入力データに対して**スカラー値のエネルギー（あるいはコスト）を割り当てる関数**を定義し、そのエネルギーを最小化するようにシステムの状態を決定・学習するという特徴を持つ。これは、ニューラルネットワークなどの高次元な状態空間における確率的な推論や学習に広く応用されている枠組みである \citep{lecun2006tutorial}。

エネルギーベースモデルでは、入力ベクトル $\mathbf{x} \in \mathbb{R}^d$ に対して、パラメータ $\theta$ に依存する**エネルギー関数** (energy function) $E_\theta : \mathbb{R}^d \to \mathbb{R}$ を定義する。このエネルギー関数は、ある状態 $\mathbf{x}$ の「好ましさ」や「自然さ」を定量的に評価するものであり、エネルギーが小さいほどその状態がより実現しやすいと解釈される。

このようなエネルギー関数を用いて、状態 $\mathbf{x}$ の**確率密度関数** $p_\theta(\mathbf{x})$ を以下のように定義する：

$$
\begin{equation}
p_\theta(\mathbf{x}) = \frac{\exp(-E_\theta(\mathbf{x}))}{Z_\theta}
\end{equation}
$$

ここで $Z_\theta:=\int \exp(-E_\theta(\mathbf{x})) \, d\mathbf{x}$ は**分配関数**（partition function）と呼ばれ、確率分布を正規化するための定数である．$Z_\theta$ は状態空間全体にわたる積分であり、一般には計算が困難である点がEBMの学習と推論を難しくする主な要因である。

このように、エネルギーベースモデルは、確率分布を明示的にパラメトライズする代わりに、各状態に対するスカラーのスコア（＝エネルギー）を割り当て、そのスコアを通じて確率的な解釈を与えるという柔軟な表現力を持つ。そのため、EBMsは画像生成、異常検知、表現学習など、多様な応用分野で注目されている。

また、エネルギー関数 $E_\theta(\mathbf{x})$ の定義により、EBMs は生成モデルとして扱うこともできるが、識別的モデルとして利用することも可能である。たとえば、識別タスクにおいては、入力 $\mathbf{x}$ とラベル $y$ のペア $(\mathbf{x}, y)$ に対して $E_\theta(\mathbf{x}, y)$ を定義し、正しいラベルに対するエネルギーを最小にするようなパラメータ $\theta$ を学習することができる。このように、EBM は生成と識別の両方の枠組みにまたがる柔軟なモデルである。

推論時と学習時の双方においてエネルギーを最小化するようにネットワークの状態を更新する

エネルギーベースモデルは、
神経系の状態遷移と安定性を記述する枠組みとして自然であり、
記憶や知覚といった脳の高次機能の数理的モデル化を可能にし、
確率的処理や最適化の観点からも神経活動の特徴をうまく表現できるため、
計算論的神経科学における理論的支柱の1つとして重要な役割を果たしています。

代謝コスト (metabolic cost) との関連．
脳は20Wしか消費しない？

ATP消費
https://www.cell.com/trends/cognitive-sciences/fulltext/S1364-6613(24)00319-X

エネルギーベースモデルでのエネルギーは代謝コストと一対一関係するものではない．
脳の代謝コストは、

ニューロンの発火活動

シナプス伝達

イオンポンプによる電位回復（たとえばNa/K ポンプ） などによって消費される**実際のエネルギー（ATPなど）**を指します。

定量的には、脳は体重の約2%しか占めないにも関わらず、体全体のエネルギー消費の20%前後を使うその大部分は神経活動、特に**シナプス活動（興奮性シナプス）**に起因する
ことが知られています。これは物理的、化学的なエネルギー消費です。