\section{躍度最小モデル}
躍度最小モデル (minimum-jerk model; \cite{Flash1985-vj})を実装する．解析的に求まるが以下では二次計画法を用いて数値的に求める．

\subsection{等式制約下の二次計画法 (Equality Constrained Quadratic Programming)}

$n$個の変数があり，$m$個の制約条件がある等式制約二次計画問題を考える．$\mathbf {x}\in \mathbb{R}^n$, 対称行列$\mathbf{P}\in \mathbb{R}^{n\times n}$,  $\mathbf {q}\in \mathbb{R}^{n}$, $\mathbf{A}\in \mathbb{R}^{m\times n}$, $\mathbf {b}\in \mathbb{R}^m$．このとき，問題は次のようになる．


\begin{align}
&{\text{Minimize}}\quad {\frac {1}{2}}\mathbf {x}^\top \mathbf{P}\mathbf {x} +\mathbf {q} ^{\top}\mathbf {x}\\
&{\text{subject to}}\quad \mathbf{A}\mathbf {x} =\mathbf {b}
\end{align}


Lagrangeの未定乗数法を用いると解は


\begin{equation}
{\begin{bmatrix}\mathbf{P}&\mathbf{A}^\top\\\mathbf{A}&0\end{bmatrix}}{\begin{bmatrix}\mathbf {x} \\
\lambda \end{bmatrix}}={\begin{bmatrix}-\mathbf {q} \\\mathbf {b} \end{bmatrix}}
\end{equation}


の解として与えられる．ここで $\lambda \in \mathbb{R}^{m}$  はLagrange乗数のベクトルである．
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/001.jl}
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/002.jl}
ちなみにjuliaでは $Ax=b$の解を出すとき，\jl{x=A^-1 * b}よりも\jl{x=A \ b}とした方がよい．
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/004.jl}
\subsection{躍度最小モデルの実装}
1次元における運動を考えよう．この仮定ではサッカードするときの眼球運動などが当てはまる．以下では \cite{Yazdani2012-sx} での問題設定を用いる．Toeplitz行列を用いた実装はYazdaniらのPythonでcvxoptを用いた実装を参考にして作成した．

問題設定は以下のようにする．


\begin{align}
&\underset{u(t)}{\operatorname{minimize}}\quad \|u(t)\|_2 \\
&\text{subject to} \quad \dot{\mathbf{x}}(t)=A \mathbf{x}(t)+B u(t)
\end{align}


ただし，$\|\cdot\|_{2}$は$L_{2}$ノルムを意味し，$A=\left[\begin{array}{lll}0 & 1 & 0 \\ 0 & 0 & 1 \\ 0 & 0 & 0\end{array}\right], B=\left[\begin{array}{l}0 \\ 0 \\ 1\end{array}\right], \mathbf{x}(t)=\left[\begin{array}{l}x(t) \\ \dot{x}(t) \\ \ddot{x}(t)\end{array}\right], u(t)=\dddot x(t)$とする．すなわち，制御信号$u(t)$は躍度$\dddot x(t)$と等しいとする．
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/006.jl}
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/007.jl}
実際には\jl{D_jerk}には\jl{(1/dt)^3}を乗じるべきであるが，二次計画法の数値的な安定性のために結果の描画の際にのみ乗じる．
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/009.jl}
二次計画法を解く．
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/011.jl}
位置解を速度，加速度，躍度に変換する．
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/013.jl}
結果を描画する．
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/015.jl}
\input{./text/motor-learning/minimum-jerk/output_015.tex}
\subsection{経由点を通る場合}
経由点問題(via-point problem)を考える．
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/017.jl}
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/018.jl}
\lstinputlisting[language=julia]{./text/motor-learning/minimum-jerk/019.jl}
\input{./text/motor-learning/minimum-jerk/output_019.tex}
