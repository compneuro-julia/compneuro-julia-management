U = u_matrix2d(w_history[end]);