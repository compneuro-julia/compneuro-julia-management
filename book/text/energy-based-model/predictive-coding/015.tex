シミュレーションを実行する関数を定義する．外側の\jl{for loop}では画像パッチの作成と\jl{r}の初期化を行う．内側の\jl{for loop}では\jl{r}が収束するまで更新を行い，収束したときに重み行列\jl{Phi}を更新する．
