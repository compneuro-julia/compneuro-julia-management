# 第4章：ニューラルネットワークと貢献度分配問題
## 貢献度分配問題

学習中に特定のシナプスがどのように選択され、異なる形態の可塑性が生じるのかは依然として不明であり、これはしばしば「クレジット割り当て問題」と呼ばれます。

どのシナプスが重要か．

生体における神経回路には、情報の入出力を中継する神経細胞が存在し、これらの細胞群は神経経路を構成している。

例えば、物体に手を伸ばして到達運動を行う際、一次運動野を経て錐体路を通り、末梢神経へと情報が伝達される（修正必要）。

この過程では、複数の神経細胞が協力して一連の運動を実現する。このような神経細胞群は、人工神経回路においては隠れ層（中間層）と呼ばれる部分に相当する。隠れ層の神経細胞は単に情報を中継しているのではなく、入力された情報を処理し、最終的な出力を改善するために重要な役割を果たしている。

このような神経回路において、特に注目すべきは、神経経路の途中に存在する細胞の活動をどのように調節すれば全体の機能を向上させることができるかという問題である。例えば、到達運動においては、物体に正確に触れること、すなわち到達誤差を最小化することが求められる。このような問題を解決するためには、各神経細胞の貢献度を適切に割り当てる必要があり、この問題を**貢献度分配問題** (credit assignment problem) と呼ぶ。

貢献度分配問題を解くためには、各神経細胞がどれだけ全体の運動結果に寄与しているかを評価し、適切に調整する必要がある。このような最適化の手法として、勾配法が広く用いられる。勾配法では、損失関数 \( L(\Theta) \) を最小化することを目的として、損失関数のパラメータに対する勾配を計算し、最適な更新を行う。具体的には、パラメータ \( \Theta = \{\theta_i\} \) （ここで \( i = 1, 2, ..., L \) は神経細胞のインデックス）に関して、損失関数の変化率である \( \delta\theta_i = \frac{dL}{d\theta_i} \) を求めることが、貢献度分配問題の解決に直結する。このようにして、個々の神経細胞の出力が全体の目標にどれだけ貢献しているかを反映させることができる。

人工神経回路における，この問題の解決策として誤差逆伝播法がある．本章では解決策の1つである誤差逆伝播法について実装し，誤差逆伝播法の何が生理的でないかを整理する．生理学的制約を付与したうえで誤差逆伝播法を近似する場合，どうすれば最適化されるのかを考える．そこから誤差逆伝播法のいくつかの近似法について整理する．

時系列問題に対しては経時的貢献度分配問題 (temporal credit assignment problem)という．

credit assignment problem 

The study of plasticity has always been about gradients

脳は学習を行う．学習を行った結果，ネットワークはよりよい状態となる．ネットワークのよさを表現するのが目的関数である．
機械学習では主に目的関数が明示的 (explicit) に与えられ，明示的に目的関数の値が改善されるように勾配降下法などでパラメータが更新される．
それでは脳には目的関数があり，その勾配を計算しているのだろうか．
これに対して否定的であったとしても，ネットワークがよい状態になるということは，勾配に部分的に従ってパラメータ更新がなされていることとなる．
つまり，脳は陰的 (implicit) に勾配降下を行っていると言える．

https://www.pnas.org/doi/10.1073/pnas.2111821118

local lossの発想

https://arxiv.org/abs/1702.07800

Stork, D. G. (1989). Is backpropagation biologically plausible. In International joint
conference on neural networks (Vol. 2, pp. 241–246).